## 一、数据处理与分析

1. **数据获取**：优先级为业务数据＞开源数据（按任务标注处理）＞爬取数据（严控质量）；需筛除脏数据，包括不符合要求、重复、异常类数据。
2. **数据分析**：核查样本均衡性，必要时做数据增强；分析句子长度（均值 + 方差、众数、中位数）；进行字 / 词分词，关注 OOV 问题；提取特征（counter 方法）。

## 二、基础模型训练与预测

1. **传统模型**：随机森林（实例化模型→ft () 训练→Predict () 预测，评估指标 Acc、recall）；fasttext 模型（含训练、部署环节）。

2. NLP 专用模型（BERT）

   - **数据处理**：构建获取方式，将数据转换为 id，处理 [CLS]、[PAD]（PAD 对应 0）、MASK 初始化；构建迭代器类，实现 next、len 方法，按批次将数据送入网络。
   - **模型构建**：基于 BERT 预训练模型，添加对应类别个数的全连接层。
   - **模型训练**：指定损失函数、优化器；遍历轮次与批次，完成前向传播、损失计算、反向传播；优化策略含指定优化器对应参数、学习率预热 + 衰减、梯度累积 / 裁剪。

   

## 三、模型部署

1. 整体流程：数据预处理（训练阶段匹配）→模型预测→后处理（将模型结果与任务匹配）。
2. 优化手段：模型量化，将参数类型从 float32 转换为 int8，实现模型压缩。

## 四、高级模型压缩方法

### （一）模型蒸馏

1. **模型设置**：老师模型与 BERT 结构一致；学生模型常用 TextCNN，需分词、构建词表并将词语转换为 id，按选择的模型结构构建。
2. **训练要点**：保证老师 / 学生模型数据对齐，采用联合损失（与 BERT 一致）+KL 散度，设置损失比例、蒸馏温度。
3. **推理**：直接使用蒸馏后的学生模型进行推理。

### （二）模型剪枝

1. **适用说明**：CNN 使用较多，NLP 中基本不使用。

2. **剪枝方法**：随机剪枝、L1 非结构化剪枝、Ln 的结构化剪枝。

3. 剪枝策略

   - 局部剪枝：需经验支撑，对指定模块剪枝；
   - 全局剪枝：在整个网络中进行剪枝；
   - 自定义剪枝：继承 prune 中的类，实现 init、Compute_mask 方法定义剪枝策略。

   

## 五、其他工具 / 框架

涉及 squ_ler、thdf 工具；模型部署使用 flask 框架。